* Custom NixOS installer ISO generator

This nix module allows us to create custom ISOs with reproducable instructions for creating cattle and pet NixOS instances.

* How to generate isos

Do this to generate ISOs for the system you are currently running

#+begin_src sh
  nix-build '<nixpkgs/nixos>' -A config.system.build.isoImage -I nixos-config=iso.nix
#+end_src

Do this to generate ISOs for an arbitrary architecture

#+begin_src sh
  nix-build '<nixpkgs/nixos>' -A config.system.build.isoImage -I nixos-config=iso.nix --argStr system i686-linux
#+end_src

* How to dump onto a USB stick.

Use ~lsblk~ to figure out the right block device name for your USB stick. If you pick the wrong one you are going to be in for a bad time >:)

#+BEGIN_SRC sh
  sudo dd if=./result/iso/nixos-<version>-<arch>.iso of=/dev/<deviceid> bs=1M
#+END_SRC

* Assumptions

We assume that the SSH public key you are using will be found at =~/.ssh/id_rsa.pub=. I don't yet know if it is possible to supply a filepath as an argument as one can do with the =system= architecture variable.
